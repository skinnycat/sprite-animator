(function(a){a.fn.spriteAnimator=function(i){sprite=this;width=sprite.width();height=sprite.height();defaults={direction:"forward",frames:1,fps:30,loop:1,rows:1,cols:1};i=a.extend({},defaults,i);currFrame=1;currCol=1;currRow=1;shortCol=i.cols;shortRow=i.rows;x=0;y=0;stop=false;frameCount=0;var d,f,e,h,b;if(i.direction==="reverse"){rowMultiplier=1;colMultiplier=1;missingFrames=(i.cols*i.rows)-i.frames;if(missingFrames>0){if(missingFrames>i.cols){rowMultiplier=(i.rows-(Math.floor(missingFrames/i.cols)))+1;colMultiplier=(i.cols-missingFrames%i.cols)+1}else{colMultiplier=missingFrames+1}}shortCol=(Math.abs(i.cols)-colMultiplier);shortRow=(Math.abs(i.rows)-rowMultiplier);x=(width*shortCol);y=(height*shortRow);width=-Math.abs(width);height=-Math.abs(height)}g(i.fps);function g(j){d=1000/j;h=Date.now();f=h;c()}function c(){if(stop){return}requestAnimationFrame(c);e=Date.now();b=e-h;if(b>d){h=e-(b%d);a(sprite).css("backgroundPosition",(-x)+"px "+(-y)+"px");if((currCol<shortCol+1)&&(currCol<i.cols)){currCol++;x=x+width}else{if(i.direction==="reverse"){currCol=1;x=width*(i.cols+1)}else{currCol=1;x=0}shortCol=i.cols;if(currRow<i.rows){currRow++;y=y+height}else{currRow=1}}currFrame++;(currFrame>Math.abs(i.frames))&&(stop=true)}}return this}}(jQuery));